.static 11 rand_buffer
.static 6 vars

loadi sp 0xFF


loadi bp .vars
loadi ra 11
store.bp ra 0
loadi ra 12
store.bp ra 1
loadi ra 13
store.bp ra 2
loadi ra 14
store.bp ra 3
loadi ra 15
store.bp ra 4
loadi ra 16
store.bp ra 5



load.bp ra, 0
push ra
load.bp ra, 1
load.bp rb, 2
call.r .fn_add
pop rb # get rid of extra slot
push ra
load.bp ra, 3
push ra
load.bp ra, 4
load.bp rb, 5
call.r .fn_add
add sp, 1 # clean up
pop rb # arg from first call
add ra, rb
out ra
halt


# add three numbers
#   INPUT
#       ra, rb, sp+2
#   OUTPUT
#       ra
.fn_add:
add ra, rb
load.sp rb, 2
add ra, rb
ret